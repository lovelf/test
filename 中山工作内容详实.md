### 周五 2016/07/01 晴
- 早上坐车从深圳宝安到中山融昊创意园，路途漫长不能一一言尽，但是宝安出发的车很难。
- 对接sso获取用用户（主账号信息） 和 customer code, 扣费对接
-  root asdasd123 172.18.1.60 2219
- 测试获取账号信息

------------

```  
<?php

    $url= 'http://183.57.41.211/coreservice/account/getaccountbyloginid';
    $method='post';    
    $arr = array(
        'nonceToken'=> time(),
        'operatorId' => -99999,
        'loginId' => 'admin',
        'language' => 'en-us',
        'data' => 'admin',
        'asyncRequest'=> false
    );
    
    $arr = json_encode($arr);  
    
    curl($url,$arr,$method);
          
    function curl($url,$post_data,$method='get') {
       $ch = curl_init();
       curl_setopt($ch, CURLOPT_URL, $url);
       
       // post数据
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_POST, 1);
           // post的变量           
        curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
        curl_setopt ($ch, CURLOPT_HEADER, 0);
        curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type:application/json', 'Charset:UTF-8'));
        $output = curl_exec($ch);
        curl_close($ch);
        //打印获得的数据
        print_r($output);
    }
    
?>
```

----------------------   

- 保存sso用户， firstname为user， 保存用户的id，parent_id,customer_code,
- sisiusa  asdasd123 副账号的id
- 理清分销单 预定单思路
- 分销单 --- 冻结资金（生产分销单->冻结资金->出库完成->扣费成功）（共享库存）
- 预订单 --- 冻结资金为0
- 分销单 预订单加上供应商供货价
-  嵌入样式
- 修改预订单 增加供货价、 对接扣费成功 获取产品价格实时的价格


### 尝试

```javascript

var canvas = document.getElementById("canvas");

var context = canvas.getContext("2d");

```

### checkout分析
- 考虑了minimum
- tax 考虑了
- total采用order的extensions->total
- booking_order字段

  字段 | 取值
  ----|---
  order_sn | 系统生成
  invoice_prefix | 取用配置里的
  store_id | 
  store_name| 
  store_url | 
  customer_id|
  customer_group_id|
  customer_field|
  language_id|
  currency_id|
  currency_code|
  currency_value|
  forwarded_ip|
  user_agent|
  accept_language|
  
- **处理cart取用的价格和供货价**  <span color="#e7e7e7"> ok </span>
- 扣费接口对接 ---

```json
   {
       "errors":null,
       "data":       
       {   
           "billingAmount":-20000.0,
           "currencyCode":"USD",
           "currencyCodeLabel":"美元",
           "billingItemCode":"distribution"
       },
       "nonceToken":null,
       "errorsToString":""
   }
```
分析errors是否只有null时才为成功的
